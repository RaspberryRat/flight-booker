<div class="index-container">
  <%= @date.nil? %>
  <h2>Choose Your Flight</h2>


  <div class="flight-search-form">
    <%= form_with url: flights_path, method: :get do |f| %>
      <%= f.label :departure_airport_id, 'Departure Airport' %>
      <%= f.collection_select :departure_airport_id, Flight.show_departure_airports, :id, :airport_code_to_name %>
      <%= f.label :arrival_airport_id, 'Arrival Airport' %>
      <%= f.collection_select :arrival_airport_id, Flight.show_arrival_airports, :id, :airport_code_to_name %>
      <%= f.label :passenger_count, 'Number of Passengers' %>
      <%= f.select :passenger_count, 1..4 %>
      <%= f.label :flight_date, 'Departure date:' %>
      <%= f.collection_select :departure_time, Flight.show_departure_dates, :departure_time, :departure_date_human_readable_format %>
      <%= f.submit "Search" %>
    <% end %>
  </div>

  <% if @flights.blank?%>
  <div></div>
  <% else %>
   <div class="flight-picker-form">
     <% if @flights.blank? && params[:departure_airport_id] %>
          <div>No Flight Available, try to search again</div>
      <% else %>
      <h2 class="flight-picker-title">Flights Available for
        <% unless params[:departure_time].nil? %>
          <%=  params[:departure_time].to_datetime.strftime('%B %e, %Y') %>
        <% end %>
      </h2>
        <%= form_with  url: new_booking_path, method: :get do |flight| %>
          <%= flight.collection_radio_buttons :flight_id, @flights.order(:departure_time).first(3), :id, :flight_details %>
          <%= flight.hidden_field :passenger_count, value: params[:passenger_count] %>
          <%= flight.submit "Choose Flight" %>
        <% end %>
      <% end %>
   </div>
   <% end %>
</div>
